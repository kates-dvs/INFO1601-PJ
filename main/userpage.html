<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
</head>

  <style>

    body{
      background-color: #A0B0B9;
    }

    .header{
      text-align: right;
    }

    section{
      margin: 20vw;
    }

    

    .r_rviews{
      display: flex;
      flex-flow: row wrap;
      justify-content: space-evenly;
    
    }
    .item{
      align-self: auto;
    }

    .column{
      background-color: #5c9598;
      text:wrap;
      width:30vw;
    }

     
    
  </style>

<body onload = "previous()" >
  
  <div class="header" id = "userHead" >
    
  </div>


  <section id="user reviews">
  <div class="r_reviews" id = "personal" >
    
  </div>
  </section>
</body>
<script>

  function previous(){
var final = sessionStorage.getItem("thisUser");
  console.log("hello");
if(final != null){ 
  let use = document.getElementById("userHead");
   use.innerHTML += `<h1>${final} is logged in</h1>`
  fetch('https://api.sheety.co/504cf0647ef153be18864c788273571e/info1601Api/ratings')
.then((response2) => response2.json())
.then(json2 => {
 for(let ratings of json2.ratings){
   if(ratings.username == final){
     console.log(ratings.isbn);
     display(ratings.isbn);
   }
}
});
}else{console.log("meh")};}

function display(isbn){
let doc = document.getElementById("personal");
fetch('https://api.sheety.co/504cf0647ef153be18864c788273571e/info1601Api/details')
.then((response4) => response4.json())
.then(json4 => {
    for(let dets of json4.details){
      if(dets.isbn == isbn){
        console.log(dets.bookTitle);
       doc.innerHTML +=  ` <item>
      <a onclick = "rating(${dets.isbn})" href = "reviewpage.html"><img src = "${dets.imageUrll}"><div>${dets.bookTitle}</div></a>
    </item>`
      }
    }
});
}

function rating(isbn){
  var someInfo = isbn;
sessionStorage.setItem("isbn1", someInfo);
}
  
</script>
</html>
